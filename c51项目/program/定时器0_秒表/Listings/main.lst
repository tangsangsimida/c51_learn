C51 COMPILER V9.54   MAIN                                                                  11/17/2022 17:25:06 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\hex\main.obj
COMPILER INVOKED BY: D:\software\keil5\C51\BIN\C51.EXE Objects\code\main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND P
                    -RINT(.\Listings\main.lst) OBJECT(.\Objects\hex\main.obj)

line level    source

   1          #include <intrins.h>
   2          #include "c51tangsang.h"
   3          #include "LCD1602_b.h"
   4          
   5          void menu_main();
   6          void menu_time();
   7          void show_time();
   8          void time_clear_0();
   9          
  10          //ÂÆöÊó∂Âô®ÂÆûÁé∞ÁßíË°®ÂäüËÉΩ
  11          //1.Âà©Áî®lcd1602Âä®ÊÄÅÊòæÁ§∫
  12          //2.Áî®Áã¨Á´ãÊåâÈîÆ1ÂÆûÁé∞ÂêØÂä®Âπ∂ÊòæÁ§∫ÁßíË°®ÁïåÈù¢
  13          //3.Áî®Áã¨Á´ãÊåâÈîÆ2ÂÆûÁé∞ÂºÄÂßãËÆ°Êó∂ÂäüËÉΩÔºåÂÜçÊ¨°Êåâ‰∏ãÁã¨Á´ãÊåâÈîÆ2ÂèØÊöÇÂÅú
  14          //4.Áî®Áã¨Á´ãÊåâÈîÆ3ÂÆûÁé∞ÁªìÊùüËÆ°Êó∂ÔºåÂπ∂Â∞ÜËÆ°Êó∂Âô®ÁΩÆÈõ∂
  15          //5.Áî®Áã¨Á´ãÊåâÈîÆ4ÂÆûÁé∞Êé®Âá∫ËÆ°Êó∂Âô®ÂäüËÉΩ
  16          //6.Êé®Âá∫ËÆ°Êó∂Âô®ÂêéÊòæÁ§∫helloÂ≠óÊ†∑ÔºåÂú®ÂêØÂä®Êó∂ÊòæÁ§∫helloÂ≠óÊ†∑
  17          
  18          uchar s=0,m=0,h=0;
  19          uint ms=0;
  20          uchar buttom_state=0;//Âà§Êñ≠ÊòØÂê¶ËøõÂÖ•ËÆ°Êó∂Âô®
  21          uchar time_begining=0;//time_begining ---->ÂÆöÊó∂Âô®ÊòØÂê¶Âú®ËøêË°å1on2off;
  22          uchar buttom_time_on_state=0;//Âú®ËÆ°Êó∂Âô®‰∏≠ÁöÑÊåâÈíÆÁä∂ÊÄÅ
  23          uchar buttom_jishi=0; //Ê≠£Âú®ËÆ°Êó∂ÁöÑÊó∂ÂÄôÁöÑÊåâÈîÆÁä∂ÊÄÅ
  24          
  25          //ÈúÄË¶ÅÂÆûÊó∂Êõ¥Êñ∞Áä∂ÊÄÅÁöÑÂèòÈáè
  26          uchar time_on_start=0; //ËÆ°Êó∂Âô®ÊòØÂê¶Ê≠£Âú®ËÆ°Êó∂1:Âú®Ôºå0Ôºö‰∏çÂú®
  27          uchar time_on=0;//ÊòØÂê¶Âú®ËÆ°Êó∂Âô®ÁïåÈù¢Ôºõ1.Âú®/ 0Ôºö‰∏çÂú®
  28          
  29          
  30          
  31          
  32          
  33          int main()
  34          {
  35   1          //
  36   1              LCD_Init();
  37   1          time_0_ms_init();
  38   1          //ÂêØÂä®ÂÆöÊó∂Âô®0;
  39   1          time_0_case=0;
  40   1      
  41   1              while(1)
  42   1              {
  43   2      begin:
  44   2              menu_main();
  45   2              //ÂàùÂßãÂåñÂºÄÂßãËèúÂçï
  46   2      
  47   2              //ËØªÂèñÂΩìÂâçÊåâÈîÆÁä∂ÊÄÅÔºåÂ¶ÇÊûú1Êåâ‰∏ãÔºåÂ∞±ËøõÂÖ•ËÆ°Êó∂Âô®Ôºõ
  48   2              buttom_state=buttom_getstate_4()+1;
  49   2              //ËøôÈáåÊúâ‰∏™bugÔºåÂ¶ÇÊûúÁõ¥Êé•ËØªÂèñËøîÂõûÂÄºÁöÑËØùËØªÂèñ1ÁöÑÊó∂ÂÄôÊØè‰∏™ÊåâÈîÆÈÉΩÂèØ‰ª•ÊéßÂà∂Ôº
             -å
  50   2              // ËøôÈáå==Â¶ÇÊûúÂêéÈù¢ÁöÑÂà§Êñ≠ÂÄº‰∏∫1ÁöÑËØùÔºåÂÆÉÊÑüËßâÂÆÉÈªòËÆ§ÊòØÂú®boolÂà§Êñ≠
  51   2              if(buttom_state==2&&time_on==0)
  52   2              {
  53   3                  time_on=1;//ÊåâÈíÆ1Ë¢´Êåâ‰∏ãÔºåËøõÂÖ•ËÆ°Êó∂Âô®,Êõ¥Êñ∞Áä∂ÊÄÅ
C51 COMPILER V9.54   MAIN                                                                  11/17/2022 17:25:06 PAGE 2   

  54   3                  menu_time();
  55   3                  buttom_time_on_state=1;
  56   3                  while(buttom_time_on_state)                                                                 //
             -ÂÆöÊó∂Âô®Á™óÂè£Âæ™ÁéØ;
  57   3                  {
  58   4                      //Â¶ÇÊûúÂΩìÂâçÂ∑≤ÁªèÂú®ÂÆöÊó∂Âô®ÈáåÈù¢‰∫ÜÔºåÂÜçÊ¨°Êåâ‰∏ãÊåâÈíÆ1Â∞±‰ºöÊé®Âá∫time_menu();
  59   4                      // ‰ΩÜÊòØÂ¶ÇÊûúËøô‰∏™Êó∂ÂÄôËÆ°Êó∂Âô®‰∏ÄÂ∑≤ÁªèÂú®Ëøê‰Ωú‰∫ÜÂ∞±‰∏çËµ∑‰ΩúÁî®
  60   4                      //time_begining ---->ÂÆöÊó∂Âô®ÊòØÂê¶Âú®ËøêË°å1 on / 2 off;
  61   4                      //Áé∞Âú®button_stateÊòØ2ÔºåÂç≥Âú®time_menuÁä∂ÊÄÅÔºåÂΩìÊÉ≥Ë¶ÅÈÄÄÂá∫Êó∂Â∞Übuttom_stateÁΩÆÈõ∂
             -Âç≥ÂèØ
  62   4                      buttom_time_on_state=buttom_getstate_4()+1;
  63   4                      if(buttom_time_on_state==2&&!time_on_start)
  64   4                      {
  65   5                          //ÂΩìÂâçÁä∂ÊÄÅÔºöÂú®ËÆ°Êó∂Âô®‰∏≠ÔºåÂπ∂‰∏îÁ¨¨‰∏Ä‰∏™ÊåâÈîÆÊåâ‰∏ãÔºåÂπ∂‰∏îËÆ°Êó∂Âô®Ê≤°Êúâ
             -ËøêË°åËÆ°Êó∂
  66   5                          //Âú®ËÆ°Êï∞Âô®‰∏≠ÔºåÊåâ‰∏ãÁ¨¨‰∏Ä‰∏™ÊåâÈîÆÔºåËøîÂõûmenu_main;
  67   5                          //ÂÖàÊääÂ±èÂπïÊ∏ÖÁ©∫ÔºåÂÜçËøîÂõûÂá∫Âéª
  68   5                          LCD_clear();
  69   5                          time_on=0;
  70   5                          buttom_time_on_state=0;
  71   5                      }
  72   4                      else if(buttom_time_on_state==3)//ÂÆöÊó∂Âô®Á™óÂè£Êåâ2ÔºåÂºÄÂßãËÆ°Êó∂
  73   4                      {
  74   5                          //Á¨¨‰∫å‰∏™ÊåâÈîÆÊåâ‰∏ãÔºåÂΩìÂâçÁä∂ÊÄÅÔºöÂú®ËÆ°Êï∞Âô®‰∏≠ÔºåÂπ∂‰∏îÊåâ‰∏ãÁ¨¨‰∫å‰∏™ÊåâÈîÆ
             ----->ÂºÄÂßãËÆ°Êó∂
  75   5                          time_on_start=1;//Êõ¥Êñ∞Áä∂ÊÄÅ---->ËÆ°Êó∂Âô®ÂºÄÂßãËÆ°Êó∂
  76   5                          time_0_case=1;
  77   5                          buttom_jishi=1;
  78   5                          while(buttom_jishi)                                                                //Ê
             -≠£Âú®ËÆ°Êó∂Á™óÂè£Âæ™ÁéØ
  79   5                          {
  80   6                              show_time();
  81   6                              buttom_jishi=buttom_getstate_4()+1;
  82   6                              if(buttom_jishi==2&&time_on_start==0)
  83   6                              {
  84   7                                  //ÂΩìÊ≤°ÊúâËÆ°Êó∂ÁöÑÊó∂ÂÄôÊåâ1ÁöÑËØùÁõ¥Êé•Êé®Âá∫ÂéªÔºåËøîÂõûÂÆöÊó∂Âô®Á™óÂè£Âæ™
             -ÁéØ
  85   7                                  buttom_time_on_state=0;
  86   7                                  //Â∞ÜÂ§ñÈÉ®Âæ™ÁéØÊù°‰ª∂ÁΩÆ‰∏∫Âê¶
  87   7                                  LCD_clear();
  88   7                                  buttom_jishi=0;
  89   7                                  time_on=0;
  90   7                              }
  91   6                              else if(buttom_jishi==3)
  92   6                              {
  93   7                                  //ËÆ°Êó∂Âô®Âú®ËÆ°Êó∂ÔºåÂπ∂‰∏îÊåâ‰∏ã‰∫ÜÊåâÈíÆ2ÔºåÂÆûÁé∞ÊöÇÂÅúÂäüËÉΩ;
  94   7                                  //ÂÖàÂà§Êñ≠ÊòØÂºÄÂßãËøòÊòØÁªßÁª≠ËÆ°Êó∂
  95   7                                  if(time_on_start==1)
  96   7                                  {
  97   8                                      time_0_case=0;
  98   8                                      time_on_start=0;
  99   8                                  }
 100   7                                  else
 101   7                                  {
 102   8                                      time_0_case=1;
 103   8                                      time_on_start=1;
 104   8                                  }
 105   7      
 106   7                              }
 107   6                              else if(buttom_jishi==4)
 108   6                              {
 109   7                                  //ËÆ°Êó∂Âô®Âú®ËÆ°Êó∂ÁöÑÂêåÊó∂ÔºåÊåâ‰∏ã‰∫ÜÊåâÈíÆ3ÔºåÂÆûÁé∞ÔºöÂ∞ÜËÆ°Êó∂Âô®ÁΩÆÈõ∂
C51 COMPILER V9.54   MAIN                                                                  11/17/2022 17:25:06 PAGE 3   

             -ÔºåÂπ∂‰∏îÊöÇÂÅúËÆ°Êó∂Ôºõ
 110   7                                  time_0_case=0;
 111   7                                  time_clear_0();
 112   7                                  time_on_start=0;
 113   7      
 114   7                              }
 115   6                              else if(buttom_jishi==5)
 116   6                              {
 117   7                                  //ËÆ°Êó∂Âô®Âú®ËÆ°Êó∂ÁöÑÂêåÊó∂ÔºåÊåâ‰∏ã‰∫ÜÊåâÈíÆ4ÔºåÂÆûÁé∞:Áõ¥Êé•Êé®Âá∫ËÆ°Êó∂Âô
             -®Ôºå
 118   7                                  // -->1.ÈÄÄÂá∫ËÆ°Êó∂Âô®‰πãÂâçÂ∫îÂΩìÂÖ≥Èó≠ËÆ°Êó∂Âô®ÔºåÂπ∂Â∞ÜËÆ°Êó∂Âô®ÁΩÆÈõ∂
 119   7      //                            time_0_case=0;// Â∞ÜËÆ°Êó∂Âô®ÊöÇÂÅúÂÖàÔºå
 120   7      //                            time_clear_0();
 121   7      //                            time_on_start=0;
 122   7      //                            buttom_state=0;
 123   7                                  //Â∞ÜÁ™óÂè£Âæ™ÁéØÊù°‰ª∂ÁΩÆÈõ∂ÔºåÊ≠£Â∏∏ËøîÂõûÂ§ñÂ±Ç
 124   7                                  time_0_case=0;
 125   7                                  time_on_start=0;
 126   7                                  time_on=0;
 127   7                                  LCD_clear();
 128   7                                  goto begin;
 129   7                              }
 130   6                          }
 131   5      
 132   5                      }
 133   4                      else if(buttom_time_on_state==4)
 134   4                      {
 135   5                          //ÂΩìÂâçÁä∂ÊÄÅÔºöÂú®ËÆ°Êï∞Âô®‰∏≠ÔºåÂπ∂‰∏îÊåâ‰∏ãÁ¨¨‰∏â‰∏™ÊåâÈîÆ
 136   5                      }
 137   4                      else if(buttom_time_on_state==5)
 138   4                      {
 139   5                          //ÂΩìÂâçÁä∂ÊÄÅÔºöÂú®ËÆ°Êï∞Âô®‰∏≠ÔºåÂπ∂‰∏îÊåâ‰∏ãÁ¨¨Âõõ‰∏™ÊåâÈîÆ
 140   5                          //Êõ¥Êñ∞Áä∂ÊÄÅ
 141   5                          time_0_case=0;
 142   5                          time_on_start=0;
 143   5                          time_on=0;
 144   5                          LCD_clear();
 145   5                          goto begin;
 146   5                      }
 147   4      
 148   4                  }
 149   3      
 150   3              }
 151   2      
 152   2      
 153   2              }
 154   1      }
 155          
 156          
 157          void time_inter() interrupt 1
 158          {
 159   1          TH0=64535/256;//È´òÂÖ´‰ΩçÊï∞ÊçÆ     Êô∂ÊåØ12mhzÔºå‰∏Ä‰∏™Âë®Êúü‰∏∫1usÔºåÊúÄÂ§ß65535usÔºå
 160   1          TL0=64535%256;//‰ΩéÂÖ´‰ΩçÊï∞ÊçÆ->64535 = 65535-1000; -> 1000us=1ms; ÂÆöÊó∂Âô®Âçï‰Ωç‰∏∫1ms
 161   1          ms++;
 162   1          if(ms==1000)
 163   1          {
 164   2              ms=0;
 165   2              s++;
 166   2              if(s==60)
 167   2              {
 168   3                 s=0;
 169   3                 m++;
C51 COMPILER V9.54   MAIN                                                                  11/17/2022 17:25:06 PAGE 4   

 170   3                 if(m==60)
 171   3                 {
 172   4                     m=0;
 173   4                     h++;
 174   4                 }
 175   3              }
 176   2          }
 177   1      }
 178          
 179          void menu_time()
 180          {
 181   1          LCD_clear();
 182   1          LCD_ShowString(1,1,"timer:");
 183   1          LCD_ShowString(2,3,":");
 184   1          LCD_ShowString(2,6,":");
 185   1          LCD_ShowString(2,9,":");
 186   1          LCD_ShowNum(2,1,0,2);
 187   1          LCD_ShowNum(2,4,0,2);
 188   1          LCD_ShowNum(2,7,0,2);
 189   1          LCD_ShowNum(2,10,0,2);
 190   1      }
 191          void show_time()
 192          {
 193   1          LCD_ShowNum(2,1,h,2);
 194   1          LCD_ShowNum(2,4,m,2);
 195   1          LCD_ShowNum(2,7,s,2);
 196   1          LCD_ShowNum(2,10,ms/100,2);
 197   1      }
 198          void menu_main()
 199          {
 200   1      //    LCD_clear();
 201   1          LCD_ShowString(1,1,"hello");
 202   1      }
 203          void time_clear_0()
 204          {
 205   1          //‰ΩúÁî®ÔºöÂ∞ÜËÆ°Êó∂Âô®ÈáçÁΩÆ
 206   1          h=0;
 207   1          m=0;
 208   1          s=0;
 209   1          ms=0;
 210   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    454    ----
   CONSTANT SIZE    =     15    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     11    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
